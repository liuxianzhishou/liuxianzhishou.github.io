import{_ as n}from"./plugin-vue_export-helper.21dcd24c.js";import{o as s,c as a,e as p}from"./app.5aebcaaa.js";var t="/assets/img_3.b8a6c40a.png";const e={},c=p('<h1 id="_1226-\u54F2\u5B66\u5BB6\u8FDB\u9910" tabindex="-1"><a class="header-anchor" href="#_1226-\u54F2\u5B66\u5BB6\u8FDB\u9910" aria-hidden="true">#</a> \u{1F315} \u{1F317} 1226. \u54F2\u5B66\u5BB6\u8FDB\u9910</h1><p>\u96BE\u5EA6: \u{1F315} \u{1F317}</p><h3 id="\u95EE\u9898\u63CF\u8FF0" tabindex="-1"><a class="header-anchor" href="#\u95EE\u9898\u63CF\u8FF0" aria-hidden="true">#</a> \u95EE\u9898\u63CF\u8FF0</h3><p><img src="'+t+`" alt="img_3.png"></p><hr><h3 id="\u89E3\u6CD5-1-semaphore" tabindex="-1"><a class="header-anchor" href="#\u89E3\u6CD5-1-semaphore" aria-hidden="true">#</a> \u89E3\u6CD5 1 - Semaphore</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">DiningPhilosophers</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u601D\u8DEF\uFF1A</span>
    <span class="token comment">// 5 \u628A\u53C9\u5B50\u53EF\u4EE5\u770B\u6210\u662F 5 \u628A\u9501\uFF0C\u6BCF\u628A\u9501\u53EA\u80FD\u88AB\u4E00\u4E2A\u7EBF\u7A0B\u5360\u6709</span>
    <span class="token comment">// \u53EF\u4EE5\u7528 ReentrantLock \u6570\u7EC4\u8868\u793A</span>
    <span class="token comment">// \u8981\u60F3\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5C31\u662F\u8BF4\uFF0C\u600E\u4E48\u6253\u7834\u6B7B\u9501\u7684\u6761\u4EF6</span>
    <span class="token comment">// \u7531\u4E8E\u4E92\u65A5 &amp; \u4E0D\u53EF\u5265\u593A\u6761\u4EF6\u5DF2\u7ECF\u5B9A\u6B7B\uFF0C\u53EF\u4EE5\u8003\u8651 \u5982\u4F55\u8BF7\u6C42\u5E76\u5360\u6709 \u4EE5\u53CA \u5FAA\u73AF\u7B49\u5F85</span>
    <span class="token comment">// method 1 - \u9650\u5236\u540C\u65F6\u6700\u591A\u53EA\u80FD 4 \u540D\u54F2\u5B66\u5BB6\u7528\u9910\uFF0C\u8D85\u51FA\u7684\u7B2C 5 \u540D\u54F2\u5B66\u5BB6\u53EA\u80FD\u963B\u585E</span>
    <span class="token class-name">ReentrantLock</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list<span class="token punctuation">;</span>
    <span class="token class-name">Semaphore</span> s<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DiningPhilosophers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>s <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Semaphore</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u53EA\u8981 &lt;= 4 \u7684\u503C\u53EF\u4EE5\u4FDD\u8BC1\u4E0D\u4F1A\u51FA\u73B0\u6B7B\u9501</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// call the run() method of any runnable to execute its code</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">wantsToEat</span><span class="token punctuation">(</span><span class="token keyword">int</span> philosopher<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickRightFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> eat<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putRightFork<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        s<span class="token punctuation">.</span><span class="token function">acquire</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5728\u62FF\u53C9\u5B50\u4E4B\u524D\u9996\u5148\u5F97\u4FDD\u8BC1\u5E76\u53D1\u4EBA\u6570 &lt; 5</span>
        <span class="token comment">// \u62FF \u5DE6\u53F3\u53C9\u5B50</span>
        <span class="token keyword">int</span> left <span class="token operator">=</span> philosopher<span class="token punctuation">;</span>
        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token punctuation">(</span>philosopher <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// +1 \u6BD4 -1 \u8981\u7B80\u5355\u4E9B\uFF0C\u5426\u5219\u5DE6\u53F3\u90FD\u8981\u518D + 5\u9632\u6B62\u51FA\u73B0\u8D1F\u6570</span>
        list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pickLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pickRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        eat<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        s<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="\u89E3\u6CD5-2-reentrantlock" tabindex="-1"><a class="header-anchor" href="#\u89E3\u6CD5-2-reentrantlock" aria-hidden="true">#</a> \u89E3\u6CD5 2 - ReentrantLock</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">DiningPhilosophers</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u601D\u8DEF\uFF1A</span>
    <span class="token comment">// 5 \u628A\u53C9\u5B50\u53EF\u4EE5\u770B\u6210\u662F 5 \u628A\u9501\uFF0C\u6BCF\u628A\u9501\u53EA\u80FD\u88AB\u4E00\u4E2A\u7EBF\u7A0B\u5360\u6709</span>
    <span class="token comment">// \u53EF\u4EE5\u7528 ReentrantLock \u6570\u7EC4\u8868\u793A</span>
    <span class="token comment">// \u8981\u60F3\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5C31\u662F\u8BF4\uFF0C\u600E\u4E48\u6253\u7834\u6B7B\u9501\u7684\u6761\u4EF6</span>
    <span class="token comment">// \u7531\u4E8E\u4E92\u65A5 &amp; \u4E0D\u53EF\u5265\u593A\u6761\u4EF6\u5DF2\u7ECF\u5B9A\u6B7B\uFF0C\u53EF\u4EE5\u8003\u8651 \u5982\u4F55\u8BF7\u6C42\u5E76\u5360\u6709 \u4EE5\u53CA \u5FAA\u73AF\u7B49\u5F85</span>
    <span class="token comment">// method 1 - \u62FF\u8D77\u5DE6\u53F3\u53C9\u5B50\u4E4B\u524D\u9700\u8981\u5148\u83B7\u53D6 doubleLock \u9501</span>
    <span class="token class-name">ReentrantLock</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list<span class="token punctuation">;</span>
    <span class="token class-name">ReentrantLock</span> doubleLock<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DiningPhilosophers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>doubleLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// call the run() method of any runnable to execute its code</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">wantsToEat</span><span class="token punctuation">(</span><span class="token keyword">int</span> philosopher<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickRightFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> eat<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putRightFork<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        doubleLock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5728\u62FF\u53C9\u5B50\u4E4B\u524D\u9996\u5148\u5F97\u83B7\u5F97\u540C\u65F6\u83B7\u5F97 2 \u628A\u9501\u7684\u8D44\u683C</span>
        <span class="token comment">// \u62FF \u5DE6\u53F3\u53C9\u5B50</span>
        <span class="token keyword">int</span> left <span class="token operator">=</span> philosopher<span class="token punctuation">;</span>
        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token punctuation">(</span>philosopher <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// +1 \u6BD4 -1 \u8981\u7B80\u5355\u4E9B\uFF0C\u5426\u5219\u5DE6\u53F3\u90FD\u8981\u518D + 5\u9632\u6B62\u51FA\u73B0\u8D1F\u6570</span>
        list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pickLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pickRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        doubleLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5728\u8FD9\u91CC\u63D0\u524D\u91CA\u653E\uFF0C\u53EF\u4EE5\u8BA9\u5176\u4ED6\u54F2\u5B66\u5BB6\u65E9\u70B9\u62FF\u81EA\u5DF1\u60F3\u8981\u7684\u94A5\u5319</span>
        eat<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="\u89E3\u6CD5-3-\u53EA\u5141\u8BB8\u4E00\u4E2A\u54F2\u5B66\u5BB6\u540C\u65F6\u7528\u9910" tabindex="-1"><a class="header-anchor" href="#\u89E3\u6CD5-3-\u53EA\u5141\u8BB8\u4E00\u4E2A\u54F2\u5B66\u5BB6\u540C\u65F6\u7528\u9910" aria-hidden="true">#</a> \u89E3\u6CD5 3 - \u53EA\u5141\u8BB8\u4E00\u4E2A\u54F2\u5B66\u5BB6\u540C\u65F6\u7528\u9910</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">DiningPhilosophers</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u601D\u8DEF\uFF1A</span>
    <span class="token comment">// 5 \u628A\u53C9\u5B50\u53EF\u4EE5\u770B\u6210\u662F 5 \u628A\u9501\uFF0C\u6BCF\u628A\u9501\u53EA\u80FD\u88AB\u4E00\u4E2A\u7EBF\u7A0B\u5360\u6709</span>
    <span class="token comment">// \u53EF\u4EE5\u7528 ReentrantLock \u6570\u7EC4\u8868\u793A</span>
    <span class="token comment">// \u8981\u60F3\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5C31\u662F\u8BF4\uFF0C\u600E\u4E48\u6253\u7834\u6B7B\u9501\u7684\u6761\u4EF6</span>
    <span class="token comment">// \u7531\u4E8E\u4E92\u65A5 &amp; \u4E0D\u53EF\u5265\u593A\u6761\u4EF6\u5DF2\u7ECF\u5B9A\u6B7B\uFF0C\u53EF\u4EE5\u8003\u8651 \u5982\u4F55\u8BF7\u6C42\u5E76\u5360\u6709 \u4EE5\u53CA \u5FAA\u73AF\u7B49\u5F85</span>
    <span class="token comment">// method 3 - \u5355\u7EBF\u7A0B\u80AF\u5B9A\u5B89\u5168\uFF0C\u53EA\u5141\u8BB8\u4E00\u4E2A\u54F2\u5B66\u5BB6\u53EF\u4EE5\u540C\u4E00\u65F6\u95F4\u7528\u9910</span>
    <span class="token comment">// ReentrantLock[] list;</span>
    <span class="token class-name">ReentrantLock</span> doubleLock<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DiningPhilosophers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// this.list = new ReentrantLock[5];</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>doubleLock <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// call the run() method of any runnable to execute its code</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">wantsToEat</span><span class="token punctuation">(</span><span class="token keyword">int</span> philosopher<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickRightFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> eat<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putRightFork<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        doubleLock<span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u5728\u62FF\u53C9\u5B50\u4E4B\u524D\u9996\u5148\u5F97\u83B7\u5F97\u540C\u65F6\u83B7\u5F97 2 \u628A\u9501\u7684\u8D44\u683C</span>
        <span class="token comment">// \u62FF \u5DE6\u53F3\u53C9\u5B50</span>
        <span class="token keyword">int</span> left <span class="token operator">=</span> philosopher<span class="token punctuation">;</span>
        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token punctuation">(</span>philosopher <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// +1 \u6BD4 -1 \u8981\u7B80\u5355\u4E9B\uFF0C\u5426\u5219\u5DE6\u53F3\u90FD\u8981\u518D + 5\u9632\u6B62\u51FA\u73B0\u8D1F\u6570</span>
        pickLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pickRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        eat<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        doubleLock<span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// \u6B64\u65F6\u4E5F\u4E0D\u9700\u8981\u7ED9\u53C9\u5B50\u52A0\u9501\u4E86</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h3 id="\u89E3\u6CD5-4-\u6253\u7834\u5FAA\u73AF\u7B49\u5F85" tabindex="-1"><a class="header-anchor" href="#\u89E3\u6CD5-4-\u6253\u7834\u5FAA\u73AF\u7B49\u5F85" aria-hidden="true">#</a> \u89E3\u6CD5 4 - \u6253\u7834\u5FAA\u73AF\u7B49\u5F85</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">DiningPhilosophers</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u601D\u8DEF\uFF1A</span>
    <span class="token comment">// 5 \u628A\u53C9\u5B50\u53EF\u4EE5\u770B\u6210\u662F 5 \u628A\u9501\uFF0C\u6BCF\u628A\u9501\u53EA\u80FD\u88AB\u4E00\u4E2A\u7EBF\u7A0B\u5360\u6709</span>
    <span class="token comment">// \u53EF\u4EE5\u7528 ReentrantLock \u6570\u7EC4\u8868\u793A</span>
    <span class="token comment">// \u8981\u60F3\u89E3\u51B3\u8FD9\u4E2A\u95EE\u9898\uFF0C\u5C31\u662F\u8BF4\uFF0C\u600E\u4E48\u6253\u7834\u6B7B\u9501\u7684\u6761\u4EF6</span>
    <span class="token comment">// \u7531\u4E8E\u4E92\u65A5 &amp; \u4E0D\u53EF\u5265\u593A\u6761\u4EF6\u5DF2\u7ECF\u5B9A\u6B7B\uFF0C\u53EF\u4EE5\u8003\u8651 \u5982\u4F55\u8BF7\u6C42\u5E76\u5360\u6709 \u4EE5\u53CA \u5FAA\u73AF\u7B49\u5F85</span>
    <span class="token comment">// method 4 - \u6253\u7834\u5FAA\u73AF\u7B49\u5F85\u6761\u4EF6\uFF0C\u53EA\u6709 5 \u4E2A\u54F2\u5B66\u5BB6\u540C\u65F6\u90FD\u62FF\u5DE6\u53C9\u5B50 | \u53F3\u53C9\u5B50\u624D\u4F1A\u51FA\u73B0\u6B7B\u9501\uFF0C</span>
    <span class="token comment">// \u53EA\u8981\u4FDD\u8BC15\u4E2A\u54F2\u5B66\u5BB6\u90E8\u5206\u5148\u62FF\u5DE6\u8FB9\uFF0C\u90E8\u5206\u5148\u62FF\u53F3\u8FB9\u5C31\u53EF\u4EE5\u6253\u7834</span>
    <span class="token class-name">ReentrantLock</span><span class="token punctuation">[</span><span class="token punctuation">]</span> list<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">DiningPhilosophers</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// call the run() method of any runnable to execute its code</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">wantsToEat</span><span class="token punctuation">(</span><span class="token keyword">int</span> philosopher<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> pickRightFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> eat<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putLeftFork<span class="token punctuation">,</span>
                           <span class="token class-name">Runnable</span> putRightFork<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u62FF \u5DE6\u53F3\u53C9\u5B50 - \u5947\u6570\u54F2\u5B66\u5BB6\u5148\u62FF\u5DE6\u8FB9\u53C9\u5B50\uFF0C\u5076\u6570\u54F2\u5B66\u5BB6\u5148\u62FF\u53F3\u8FB9\u53C9\u5B50</span>
        <span class="token keyword">int</span> left <span class="token operator">=</span> philosopher<span class="token punctuation">;</span>
        <span class="token keyword">int</span> right <span class="token operator">=</span> <span class="token punctuation">(</span>philosopher <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// +1 \u6BD4 -1 \u8981\u7B80\u5355\u4E9B\uFF0C\u5426\u5219\u5DE6\u53F3\u90FD\u8981\u518D + 5\u9632\u6B62\u51FA\u73B0\u8D1F\u6570</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>philosopher <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        pickLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        pickRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        eat<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putLeftFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        putRightFork<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>philosopher <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            list<span class="token punctuation">[</span>right<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            list<span class="token punctuation">[</span>left<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,16),o=[c];function l(i,u){return s(),a("div",null,o)}var d=n(e,[["render",l],["__file","1226.html.vue"]]);export{d as default};
